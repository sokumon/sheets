var DataTable=function(t){"use strict";function e(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function n(){const t=document.createElement("div");e.style(t,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(t);const n=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),n}function i(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function o(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function s(t){var e=Dt.call(t,Nt),n=t[Nt];try{t[Nt]=void 0}catch(t){}var i=zt.call(t);return e?t[Nt]=n:delete t[Nt],i}function r(t){return Pt.call(t)}function l(t){return null==t?void 0===t?Kt:Ut:Zt&&Zt in Object(t)?qt(t):Vt(t)}function c(t){return null!=t&&"object"==typeof t}function a(t){return"symbol"==typeof t||Xt(t)&&Gt(t)==Yt}function h(t){if("number"==typeof t)return t;if(Jt(t))return Qt;if(Et(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Et(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(te,"");var n=ne.test(t);return n||ie.test(t)?oe(t.slice(2),n?2:8):ee.test(t)?Qt:+t}function u(t,e,n){function i(e){var n=d,i=f;return d=f=void 0,C=e,p=t.apply(i,n)}function o(t){return C=t,m=setTimeout(l,e),y?i(t):p}function s(t){var n=t-C,i=e-(t-w);return b?ae(i,g-n):i}function r(t){var n=t-w,i=t-C;return void 0===w||n>=e||n<0||b&&i>=g}function l(){var t=re();if(r(t))return c(t);m=setTimeout(l,s(t))}function c(t){return m=void 0,v&&d?i(t):(d=f=void 0,p)}function a(){void 0!==m&&clearTimeout(m),C=0,d=w=f=m=void 0}function h(){return void 0===m?p:c(re())}function u(){var t=re(),n=r(t);if(d=arguments,f=this,w=t,n){if(void 0===m)return o(w);if(b)return m=setTimeout(l,e),i(w)}return void 0===m&&(m=setTimeout(l,e)),p}var d,f,g,p,m,w,C=0,y=!1,b=!1,v=!0;if("function"!=typeof t)throw new TypeError(le);return e=se(e)||0,Et(n)&&(y=!!n.leading,g=(b="maxWait"in n)?ce(se(n.maxWait)||0,e):g,v="trailing"in n?!!n.trailing:v),u.cancel=a,u.flush=h,u}function d(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError(ue);return Et(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),he(t,e,{leading:i,maxWait:e,trailing:o})}function f(t){if(!Et(t))return!1;var e=Gt(t);return e==ge||e==pe||e==fe||e==me}function g(t){return!!ve&&ve in t}function p(t){if(null!=t){try{return xe.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function m(t){return!(!Et(t)||_e(t))&&(we(t)?Le:Se).test(Ie(t))}function w(t,e){return null==t?void 0:t[e]}function C(t,e){var n=Oe(t,e);return $e(n)?n:void 0}function y(){this.__data__=De?De(null):{},this.size=0}function b(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function v(t){var e=this.__data__;if(De){var n=e[t];return n===Be?void 0:n}return Pe.call(e,t)?e[t]:void 0}function _(t){var e=this.__data__;return De?void 0!==e[t]:qe.call(e,t)}function x(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=De&&void 0===e?Ke:e,this}function I(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function S(){this.__data__=[],this.size=0}function R(t,e){return t===e||t!==t&&e!==e}function E(t,e){for(var n=t.length;n--;)if(en(t[n][0],e))return n;return-1}function k(t){var e=this.__data__,n=nn(e,t);return!(n<0)&&(n==e.length-1?e.pop():on.call(e,n,1),--this.size,!0)}function T(t){var e=this.__data__,n=nn(e,t);return n<0?void 0:e[n][1]}function L(t){return nn(this.__data__,t)>-1}function H(t,e){var n=this.__data__,i=nn(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function M(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function O(){this.size=0,this.__data__={hash:new Xe,map:new(fn||dn),string:new Xe}}function $(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function A(t,e){var n=t.__data__;return mn(e)?n["string"==typeof e?"string":"hash"]:n.map}function j(t){var e=wn(this,t).delete(t);return this.size-=e?1:0,e}function F(t){return wn(this,t).get(t)}function D(t){return wn(this,t).has(t)}function z(t,e){var n=wn(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function N(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function W(t){return this.__data__.set(t,En),this}function B(t){return this.__data__.has(t)}function P(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Ln;++e<n;)this.add(t[e])}function V(t,e,n,i){for(var o=t.length,s=n+(i?1:-1);i?s--:++s<o;)if(e(t[s],s,t))return s;return-1}function q(t){return t!==t}function U(t,e,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1}function K(t,e,n){return e===e?Fn(t,e,n):On(t,$n,n)}function Z(t,e){return!!(null==t?0:t.length)&&Dn(t,e,0)>-1}function G(t,e,n){for(var i=-1,o=null==t?0:t.length;++i<o;)if(n(e,t[i]))return!0;return!1}function X(t,e){return t.has(e)}function Y(){}function J(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function Q(t,e,n){var i=-1,o=zn,s=t.length,r=!0,l=[],c=l;if(n)r=!1,o=Nn;else if(s>=Gn){var a=e?null:Kn(t);if(a)return qn(a);r=!1,o=Wn,c=new Zn}else c=e?[]:l;t:for(;++i<s;){var h=t[i],u=e?e(h):h;if(h=n||0!==h?h:0,r&&u===u){for(var d=c.length;d--;)if(c[d]===u)continue t;e&&c.push(u),l.push(h)}else o(c,u,n)||(c!==l&&c.push(u),l.push(h))}return l}function tt(t){return t&&t.length?Jn(t):[]}function et(t){return t.replace(/([A-Z])/g,t=>`-${t[0].toLowerCase()}`)}function nt(t){return Object.keys(t).map(e=>{const n=et(e);const i=t[e];if(void 0===i)return"";return`data-${n}="${i}" `}).join("").trim()}function it(t){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(e)}function ot(t){return!isNaN(t)}function st(t,e=null){return(...n)=>new Promise(i=>{const o=()=>{const o=t.apply(e,n);i(o)};setTimeout(o)})}function rt(t,e,n){const i=n.reduce((t,n)=>{t[n]={get(){return e[n]}};return t},{});Object.defineProperties(t,i)}function lt(t){return void 0!==t||null!==t}function ct(t){return!lt(t)}function at(t){return!isNaN(t)}function ht(t){return Array.isArray(t)?t:[t]}function ut(t){return Qn(t)}function dt(t,e){return t-e}function ft(t){return t.replace(/<[^>]*>/g,"")}function gt(t,e){return t?(Object.keys(e).forEach(n=>{let i=new RegExp(`{(${n})}`,"g");t=t.replace(i,e[n])}),t):t}function pt(t){if(!t)return"";let e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(t).replace(/[&<>"'`=/]/g,t=>e[t]||t)}function mt(t){return 0==t.length}function wt(){return{en:fi,de:gi,fr:pi,it:mi}}function Ct(t,e,n){let i=[];if(0===Object.keys(e).length)return t.map(t=>t.meta.rowIndex);for(let o in e){const s=e[o],r=i.length?i.map(e=>t[e]):t,l=r.map(t=>t[o]);let c=bt(s),a=yt(t,n,c);i=a?a(c.text,l):l.map(t=>t.rowIndex)}return i}function yt(t,e,n){const i=i=>{let o=si.getCustomCellFormatter(i);let s=t[i.rowIndex];e&&e.data&&e.data.length&&(s=e.data[i.rowIndex]);if(o&&i.content)return i.html=o(i.content,t[i.rowIndex],i.column,s,n),ft(i.html);return i.content||""},o=t=>String(ft(t.html||"")||i(t)).toLowerCase(),s=t=>parseFloat(t.content),r=(t,e)=>{if(t.column.compareValue){const n=t.column.compareValue(t,e);if(n&&Array.isArray(n))return n}const n=s(t);if(!isNaN(n))return[n,e];return[o(t),e]};return{contains(t,e){return e.filter(e=>{const n=(t||"").toLowerCase();return!n||(e.content||"").toLowerCase().includes(n)||o(e).includes(n)}).map(t=>t.rowIndex)},greaterThan(t,e){return e.filter(e=>{const[n,i]=r(e,t);return n>i}).map(t=>t.rowIndex)},lessThan(t,e){return e.filter(e=>{const[n,i]=r(e,t);return n<i}).map(t=>t.rowIndex)},equals(t,e){return e.filter(e=>{const n=parseFloat(e.content);return n===t}).map(t=>t.rowIndex)},notEquals(t,e){return e.filter(e=>{const n=parseFloat(e.content);return n!==t}).map(t=>t.rowIndex)},range(t,e){return e.filter(e=>{const n=r(e,t[0]);const i=r(e,t[1]);const o=n[0];return o>=n[1]&&o<=i[1]}).map(t=>t.rowIndex)},containsNumber(t,e){return e.filter(e=>{let n=parseFloat(t,10);let i=t;let r=s(e);let l=o(e);return n===r||l.includes(i)}).map(t=>t.rowIndex)}}[n.type]}function bt(t=""){if(0===t.length)return{};let e=t;return[">","<","="].includes(e[0])?e=t.slice(1):e.startsWith("!=")&&(e=t.slice(2)),t.startsWith(">")&&e?{type:"greaterThan",text:e.trim()}:t.startsWith("<")&&e?{type:"lessThan",text:e.trim()}:t.startsWith("=")&&at(e)?{type:"equals",text:Number(t.slice(1).trim())}:at(e)?{type:"containsNumber",text:e}:t.startsWith("!=")&&at(e)?{type:"notEquals",text:Number(t.slice(2).trim())}:2===t.split(":").length&&t.split(":").every(t=>at(t.trim()))?(e=t.split(":"),{type:"range",text:e.map(t=>t.trim())}):{type:"contains",text:e.toLowerCase()}}function vt(t){return{columns:[],data:[],dropdownButton:oi.chevronDown,headerDropdown:[{label:t.translate("Sort Ascending"),action:function(t){this.sortColumn(t.colIndex,"asc")}},{label:t.translate("Sort Descending"),action:function(t){this.sortColumn(t.colIndex,"desc")}},{label:t.translate("Reset sorting"),action:function(t){this.sortColumn(t.colIndex,"none")}},{label:t.translate("Remove column"),action:function(t){this.removeColumn(t.colIndex)}}],events:{onRemoveColumn(t){},onSwitchColumn(t,e){},onSortColumn(t){},onCheckRow(t){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"↑",desc:"↓",none:""},overrideComponents:{},filterRows:Ct,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:t.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}function _t(t){let{rowIndex:rowIndex,colIndex:colIndex}=e.data(t);return{row:rowIndex,col:colIndex}}function xt(t,e){return document.querySelector(`[data-row-index="${t}"][data-col-index="${e}"]`)}function It(t){return{row:parseInt(t.replace(/\D/g,""))-1,col:t.charCodeAt(0)-64}}function St(t){let e=It(t);return xt(e.row,e.col)}function Rt(t,e){return t=parseInt(t),e=parseInt(e),`${String.fromCharCode(64+e)}${t+1}`}t=t&&t.hasOwnProperty("default")?t.default:t,e.each=((t,e)=>"string"==typeof t?Array.from((e||document).querySelectorAll(t)):t||null),e.create=((t,n)=>{let i=document.createElement(t);for(let t in n){let o=n[t];if("inside"===t)e(o).appendChild(i);else if("around"===t){let t=e(o);t.parentNode.insertBefore(i,t),i.appendChild(t)}else"styles"===t?"object"==typeof o&&Object.keys(o).map(t=>{i.style[t]=o[t]}):t in i?i[t]=o:i.setAttribute(t,o)}return i}),e.on=((t,n,i,o)=>{o?e.delegate(t,n,i,o):(o=i,e.bind(t,n,o))}),e.off=((t,e,n)=>{t.removeEventListener(e,n)}),e.bind=((t,e,n)=>{e.split(/\s+/).forEach(function(e){t.addEventListener(e,n)})}),e.delegate=((t,e,n,i)=>{t.addEventListener(e,function(t){const e=t.target.closest(n);e&&(t.delegatedTarget=e,i.call(this,t,e))})}),e.unbind=((t,e)=>{if(t)for(let n in e){let i=e[n];n.split(/\s+/).forEach(function(e){t.removeEventListener(e,i)})}}),e.fire=((t,e,n)=>{let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0);for(let t in n)i[t]=n[t];return t.dispatchEvent(i)}),e.data=((t,e)=>{if(!e)return t.dataset;for(const n in e)t.dataset[n]=e[n]}),e.style=((t,n)=>{if("string"==typeof n)return e.getStyle(t,n);Array.isArray(t)||(t=[t]);t.map(t=>{for(const e in n)t.style[e]=n[e]})}),e.removeStyle=((t,e)=>{Array.isArray(t)||(t=[t]);Array.isArray(e)||(e=[e]);t.map(t=>{for(const n of e)t.style[n]=""})}),e.getStyle=((t,e)=>{if(!e)return getComputedStyle(t);let n=getComputedStyle(t)[e];["width","height"].includes(e)&&(n=parseFloat(n));return n}),e.closest=((t,n)=>{if(!n)return null;if(n.matches(t))return n;return e.closest(t,n.parentNode)}),e.inViewport=((t,e)=>{const{top:top,left:left,bottom:bottom,right:right}=t.getBoundingClientRect();const{top:pTop,left:pLeft,bottom:pBottom,right:pRight}=e.getBoundingClientRect();return top>=pTop&&left>=pLeft&&bottom<=pBottom&&right<=pRight}),e.scrollTop=function(t,e){requestAnimationFrame(()=>{t.scrollTop=e})},e.scrollbarSize=function(){return e.scrollBarSizeValue||(e.scrollBarSizeValue=n()),e.scrollBarSizeValue},e.hasVerticalOverflow=function(t){return t.scrollHeight>t.offsetHeight+10},e.hasHorizontalOverflow=function(t){return t.scrollWidth>t.offsetWidth+10},e.measureTextWidth=function(t){const e=document.createElement("div");return e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",e.innerText=t,document.body.appendChild(e),e.clientWidth+1};var Et=i,kt="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Tt="object"==typeof kt&&kt&&kt.Object===Object&&kt,Lt="object"==typeof self&&self&&self.Object===Object&&self,Ht=Tt||Lt||Function("return this")(),Mt=function(){return Ht.Date.now()},Ot=Object.freeze({default:Mt,__moduleExports:Mt}),$t=Ht.Symbol,At=Object.freeze({default:$t,__moduleExports:$t}),jt=At&&$t||At,Ft=Object.prototype,Dt=Ft.hasOwnProperty,zt=Ft.toString,Nt=jt?jt.toStringTag:void 0,Wt=s,Bt=Object.freeze({default:Wt,__moduleExports:Wt}),Pt=Object.prototype.toString,Vt=r,qt=Bt&&Wt||Bt,Ut="[object Null]",Kt="[object Undefined]",Zt=jt?jt.toStringTag:void 0,Gt=l,Xt=c,Yt="[object Symbol]",Jt=a,Qt=NaN,te=/^\s+|\s+$/g,ee=/^[-+]0x[0-9a-f]+$/i,ne=/^0b[01]+$/i,ie=/^0o[0-7]+$/i,oe=parseInt,se=h,re=Ot&&Mt||Ot,le="Expected a function",ce=Math.max,ae=Math.min,he=u,ue="Expected a function",de=d,fe="[object AsyncFunction]",ge="[object Function]",pe="[object GeneratorFunction]",me="[object Proxy]",we=f,Ce=Ht["__core-js_shared__"],ye=Object.freeze({default:Ce,__moduleExports:Ce}),be=ye&&Ce||ye,ve=function(){var t=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),_e=g,xe=Function.prototype.toString,Ie=p,Se=/^\[object .+?Constructor\]$/,Re=Function.prototype,Ee=Object.prototype,ke=Re.toString,Te=Ee.hasOwnProperty,Le=RegExp("^"+ke.call(Te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=m,Me=Object.freeze({default:He,__moduleExports:He}),Oe=w,$e=Me&&He||Me,Ae=C,je=Object.freeze({default:Ae,__moduleExports:Ae}),Fe=je&&Ae||je,De=Fe(Object,"create"),ze=y,Ne=b,We=Object.freeze({default:Ne,__moduleExports:Ne}),Be="__lodash_hash_undefined__",Pe=Object.prototype.hasOwnProperty,Ve=v,qe=Object.prototype.hasOwnProperty,Ue=_,Ke="__lodash_hash_undefined__",Ze=x,Ge=We&&Ne||We;I.prototype.clear=ze,I.prototype.delete=Ge,I.prototype.get=Ve,I.prototype.has=Ue,I.prototype.set=Ze;var Xe=I,Ye=S,Je=Object.freeze({default:Ye,__moduleExports:Ye}),Qe=R,tn=Object.freeze({default:Qe,__moduleExports:Qe}),en=tn&&Qe||tn,nn=E,on=Array.prototype.splice,sn=k,rn=T,ln=L,cn=Object.freeze({default:ln,__moduleExports:ln}),an=H,hn=Je&&Ye||Je,un=cn&&ln||cn;M.prototype.clear=hn,M.prototype.delete=sn,M.prototype.get=rn,M.prototype.has=un,M.prototype.set=an;var dn=M,fn=Fe(Ht,"Map"),gn=O,pn=Object.freeze({default:gn,__moduleExports:gn}),mn=$,wn=A,Cn=j,yn=Object.freeze({default:Cn,__moduleExports:Cn}),bn=F,vn=D,_n=z,xn=pn&&gn||pn,In=yn&&Cn||yn;N.prototype.clear=xn,N.prototype.delete=In,N.prototype.get=bn,N.prototype.has=vn,N.prototype.set=_n;var Sn=N,Rn=Object.freeze({default:Sn,__moduleExports:Sn}),En="__lodash_hash_undefined__",kn=W,Tn=B,Ln=Rn&&Sn||Rn;P.prototype.add=P.prototype.push=kn,P.prototype.has=Tn;var Hn=P,Mn=Object.freeze({default:Hn,__moduleExports:Hn}),On=V,$n=q,An=U,jn=Object.freeze({default:An,__moduleExports:An}),Fn=jn&&An||jn,Dn=K,zn=Z,Nn=G,Wn=X,Bn=Fe(Ht,"Set"),Pn=Object.freeze({default:Bn,__moduleExports:Bn}),Vn=Y,qn=J,Un=Pn&&Bn||Pn,Kn=Un&&1/qn(new Un([,-0]))[1]==1/0?function(t){return new Un(t)}:Vn,Zn=Mn&&Hn||Mn,Gn=200,Xn=Q,Yn=Object.freeze({default:Xn,__moduleExports:Xn}),Jn=Yn&&Xn||Yn,Qn=tt;let ti=de,ei=he;class ni{constructor(t){this.options=t,this.sortRows=st(this.sortRows,this),this.switchColumn=st(this.switchColumn,this),this.removeColumn=st(this.removeColumn,this),this.options.filterRows=st(this.options.filterRows,this)}init(t,e){t||(t=this.options.data),e&&(this.options.columns=e),this.data=t,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.validateData(this.data),this.rows=this.prepareRows(this.data),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(t=>"none"!==t.sortOrder)||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){const t={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(t)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let t={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(t)}}prepareHeader(){let t=this.columns.concat(this.options.columns);const e={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:t=>{if(null===t||void 0===t)return"";return t+""}};this.columns=t.map((t,e)=>this.prepareCell(t,e)).map(t=>Object.assign({},e,t)).map(t=>{t.content=t.content||t.name||"";t.id=t.id||t.content;return t})}prepareCell(t,e){const n={content:"",sortOrder:"none",colIndex:e,column:this.columns[e]};return null!==t&&"object"==typeof t?Object.assign(n,t):n.content=t,n}prepareNumericColumns(){const t=this.getRow(0);t&&(this.columns=this.columns.map((e,n)=>{const i=t[n].content;!e.align&&ot(i)&&(e.align="right");return e}))}prepareRows(t){return t.map((t,e)=>{const n=this._getNextRowCount();let i=[];let o={rowIndex:n};if(Array.isArray(t))for(this.options.checkboxColumn&&i.push(this.getCheckboxHTML()),this.options.serialNoColumn&&i.push(n+1+""),i=i.concat(t);i.length<this.columns.length;)i.push("");else{for(let e of this.columns)"_checkbox"===e.id?i.push(this.getCheckboxHTML()):"_rowIndex"===e.id?i.push(n+1+""):i.push(t[e.id]);o.indent=t.indent||0}return this.prepareRow(i,o)})}prepareTreeRows(){this.rows.forEach((t,e)=>{if(at(t.meta.indent)){const n=this.getRow(e+1);t.meta.isLeaf=!n||ct(n.meta.indent)||n.meta.indent<=t.meta.indent,t.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(t=>t.meta.rowIndex)}prepareRow(t,e){const n={rowIndex:e.rowIndex,indent:e.indent};return t=t.map((t,e)=>this.prepareCell(t,e)).map(t=>Object.assign({},n,t)),t.meta=e,t}validateColumns(){const t=this.options.columns;if(!Array.isArray(t))throw new ii("`columns` must be an array");t.forEach((t,e)=>{if("string"!=typeof t&&"object"!=typeof t)throw new ii(`column "${e}" must be a string or an object`)})}validateData(t){if(Array.isArray(t)&&(0===t.length||Array.isArray(t[0])||"object"==typeof t[0]))return!0;throw new ii("`data` must be an array of arrays or objects")}appendRows(t){this.validateData(t),this.rows=this.rows.concat(this.prepareRows(t)),this.prepareTreeRows(),this.prepareRowView()}sortRows(t,e="none"){t=+t,this.getColumns().map(n=>{n.colIndex===t?n.sortOrder=e:n.sortOrder="none"}),this._sortRows(t,e)}_sortRows(t,e){if(this.currentSort.colIndex===t&&("asc"===this.currentSort.sortOrder&&"desc"===e||"desc"===this.currentSort.sortOrder&&"asc"===e))return this.reverseArray(this.rowViewOrder),void(this.currentSort.sortOrder=e);if(this.rowViewOrder.sort((n,i)=>{const o=n;const s=i;let r=this.getCell(t,n).content;let l=this.getCell(t,i).content;r=null==r?"":r;l=null==l?"":l;if("none"===e)return o-s;if("asc"===e){if(r<l)return-1;if(r>l)return 1;if(r===l)return 0}else if("desc"===e){if(r<l)return 1;if(r>l)return-1;if(r===l)return 0}return 0}),this.hasColumnById("_rowIndex")){const t=this.getColumnIndexById("_rowIndex");this.rows.forEach((e,n)=>{const i=this.rowViewOrder.indexOf(n);const o=e[t];o.content=i+1+""})}}reverseArray(t){let e=null,n=null;for(e=0,n=t.length-1;e<n;e+=1,n-=1){const i=t[e];t[e]=t[n],t[n]=i}}switchColumn(t,e){const n=this.columns[t];this.columns[t]=this.columns[e],this.columns[e]=n,this.columns[t].colIndex=t,this.columns[e].colIndex=e,this.rows.forEach(n=>{const i=Object.assign({},n[t],{colIndex:e});const o=Object.assign({},n[e],{colIndex:t});n[e]=i;n[t]=o})}removeColumn(t){t=+t;const e=e=>e.colIndex!==t,n=(t,e)=>Object.assign({},t,{colIndex:e});this.columns=this.columns.filter(e).map(n),this.rows.forEach(e=>{e.splice(t,1);e.forEach((t,e)=>{t.colIndex=e})})}updateRow(t,e){if(t.length<this.columns.length){if(this.hasColumnById("_rowIndex")){const n=e+1+"";t=[n].concat(t)}if(this.hasColumnById("_checkbox")){const e='<input type="checkbox" />';t=[e].concat(t)}}const n=this.prepareRow(t,{rowIndex:e}),i=this.rows.findIndex(t=>t[0].rowIndex===e);return this.rows[i]=n,n}updateCell(t,e,n){let i;"object"==typeof t&&(t=(i=t).colIndex,e=i.rowIndex,n=i),i=this.getCell(t,e);for(let t in n){const e=n[t];void 0!==e&&(i[t]=e)}return i}updateColumn(t,e){const n=this.getColumn(t);for(let t in e){const i=e[t];void 0!==i&&(n[t]=i)}return n}filterRows(t){return this.options.filterRows(this.rows,t,this).then(t=>{t||(t=this.getAllRowIndices());t.then||(t=Promise.resolve(t));return t.then(t=>{this._filteredRows=t;const e=this.getAllRowIndices().filter(e=>!t.includes(e));return{rowsToHide:e,rowsToShow:t}})})}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(t=>t.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){const t=this.rowCount;return this.rowCount++,t}getRows(t,e){return this.rows.slice(t,e)}getRowsForView(t,e){return this.rowViewOrder.map(t=>this.rows[t]).slice(t,e)}getColumns(t){let e=this.columns;return t&&(e=e.slice(this.getStandardColumnCount())),e}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(t){let e=this.columns.length;return t&&(e-=this.getStandardColumnCount()),e}getColumn(t){return(t=+t)<0&&(t=this.columns.length+t),this.columns.find(e=>e.colIndex===t)}getColumnById(t){return this.columns.find(e=>e.id===t)}getRow(t){return t=+t,this.rows[t]}getCell(t,e){return e=+e,t=+t,this.getRow(e)[t]}getChildren(t){t=+t;const e=this.getRow(t).meta.indent,n=[];for(let i=t+1;i<this.rowCount;i++){const t=this.getRow(i);if(!isNaN(t.meta.indent)&&(t.meta.indent>e&&n.push(i),t.meta.indent===e))break}return n}getImmediateChildren(t){t=+t;const e=this.getRow(t).meta.indent,n=[],i=e+1;for(let o=t+1;o<this.rowCount;o++){const t=this.getRow(o);if(!(isNaN(t.meta.indent)||t.meta.indent>i)&&(t.meta.indent===i&&n.push(o),t.meta.indent===e))break}return n}get(){return{columns:this.columns,rows:this.rows}}getData(t){return this.data[t]}hasColumn(t){return Boolean(this.columns.find(e=>e.content===t))}hasColumnById(t){return Boolean(this.columns.find(e=>e.id===t))}getColumnIndex(t){return this.columns.findIndex(e=>e.content===t)}getColumnIndexById(t){return this.columns.findIndex(e=>e.id===t)}getCheckboxHTML(){return'<input type="checkbox" />'}}class ii extends TypeError{}let oi={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'};class si{constructor(t){this.instance=t,rt(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard","autocomplete","cellselection","observer"]),this.bindEvents(),this.formulaSuggest=e(".formula-suggest"),this.choosenCell=null,this.prevChoosenCell=null}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindClearCells()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,e.on(this.bodyScrollable,"dblclick",".dt-cell",(t,e)=>{if(this.cellselection.cellChoosingMode)return;this.activateEditing(e)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindClearCells(){this.keyboard.on("backspace",()=>{if(this.$editingCell)return void console.log("Editing cell");if(this._selectedCells.length>0){let t=[];for(let n=0;n<this._selectedCells.length;n++){const i=e.data(this._selectedCells[n]);this.updateCell(i.colIndex,i.rowIndex,"",!0),t.push(i.rowIndex,i.colIndex)}}})}bindKeyboardNav(){const t=t=>{if(!this.$focusedCell||this.$editingCell)return!1;let n=this.$focusedCell;const{rowIndex:rowIndex,colIndex:colIndex}=e.data(n);"left"===t?n=this.getLeftMostCell$(rowIndex):"right"===t?n=this.getRightMostCell$(rowIndex):"up"===t?n=this.getTopMostCell$(colIndex):"down"===t&&(n=this.getBottomMostCell$(colIndex));this.focusCell(n);return!0};["left","right","up","down","tab","shift+tab"].map(t=>this.keyboard.on(t,()=>this.focusCellInDirection(t))),["left","right","up","down"].map(e=>this.keyboard.on(`ctrl+${e}`,()=>t(e))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1);this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",t=>{const n=e.closest(".dt-cell",t.target);const{colIndex:colIndex}=e.data(n);this.activateFilter(colIndex);return!0}),e.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){const t=t=>{let e=this.getSelectionCursor();"left"===t?e=this.getLeftCell$(e):"right"===t?e=this.getRightCell$(e):"up"===t?e=this.getAboveCell$(e):"down"===t&&(e=this.getBelowCell$(e));return e};["left","right","up","down"].map(e=>this.keyboard.on(`shift+${e}`,()=>this.selectArea(t(e))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{const t=this.copyCellContents(this.$focusedCell,this.$selectionCursor);const e=this.instance.translate("{count} cells copied",{count:t});t&&this.instance.showToastMessage(e,2)}),this.options.pasteFromClipboard&&(console.log(this.instance.options),this.keyboard.on("ctrl+v",t=>{this.instance.pasteTarget.focus();setTimeout(()=>{const t=this.instance.pasteTarget.value;this.instance.pasteTarget.value="";this.pasteContentInCell(t)},10);return!1}))}bindMouseEvents(){let t=null;e.on(this.bodyScrollable,"mousedown",".dt-cell",n=>{t=!0;this.cellselection.cellChoosingMode?this.cellselection.selectCell(e(n.delegatedTarget)):this.focusCell(e(n.delegatedTarget))}),e.on(this.bodyScrollable,"mouseup",()=>{t=!1});const n=n=>{if(!t)return;this.cellselection.cellChoosingMode?(this.cellselection.selectedCells&&this.cellselection.cleanup(this.cellselection.selectedCells),this.cellselection.groupSelectCells(e(n.delegatedTarget))):this.selectArea(e(n.delegatedTarget))};e.on(this.bodyScrollable,"mousemove",".dt-cell",ti(n,50))}bindTreeEvents(){e.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(t,n)=>{const i=e.closest(".dt-cell",n);const{rowIndex:rowIndex}=e.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(rowIndex):this.rowmanager.closeSingleNode(rowIndex)})}cellRangeSelection(t){this._selectArea(this.choosenCell,t)&&(this.$selectionCursor=t)}chooseCell(t){if(t===this.$editingCell)return void console.trace();const{colIndex:colIndex,rowIndex:rowIndex}=e.data(t);if(t!=this.$editingCell){this.choosenCell&&this.choosenCell.classList.remove("dt-cell--cellSelected"),t.classList.add("dt-cell--cellSelected"),this.choosenCell&&t!==this.choosenCell&&(this._selectedCells.length>1?(this.cellselection.cleanup(this._selectedCells),this._selectedCells=[]):this.choosenCell=null);const e=new CustomEvent("chooseCell",{detail:{cell:[parseInt(colIndex),parseInt(rowIndex)]}});this.instance.wrapper.dispatchEvent(e),this.choosenCell=t}}focusCell(t,{skipClearSelection:skipClearSelection=0,skipDOMFocus:skipDOMFocus=0,skipScrollToCell:skipScrollToCell=0}={}){if(t&&t!==this.$editingCell){const{colIndex:colIndex,rowIndex:rowIndex,isHeader:isHeader}=e.data(t);if(!isHeader&&!1!==this.columnmanager.getColumn(colIndex).focusable){skipScrollToCell||this.scrollToCell(t),this.cellselection.cellChoosingMode||this.deactivateEditing(),skipClearSelection||this.clearSelection(),this.$focusedCell&&(this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell.classList.remove("dt-cell--cellSelected")),this.$focusedCell=t,this.cellselection.cellChoosingMode?t.classList.add("dt-cell--cellSelected"):t.classList.add("dt-cell--focus"),t.classList.add("dt-cell--focus"),skipDOMFocus||t.focus();const e=new CustomEvent("focusCell",{detail:{rowIndex:rowIndex,colIndex:colIndex}});this.instance.wrapper.dispatchEvent(e),this.highlightRowColumnHeader(t)}}}unfocusCell(t){t&&(t.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(t){const{colIndex:colIndex,rowIndex:rowIndex}=e.data(t),n=`.dt-cell--header-${colIndex}`,i=`.dt-cell--${this.datamanager.getColumnIndexById("_rowIndex")}-${rowIndex}`;this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight"));const o=e(n,this.wrapper),s=e(i,this.wrapper);this.lastHeaders=[o,s],this.lastHeaders.forEach(t=>t&&t.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(this.$focusedCell&&this.$selectionCursor){const{colIndex:colIndex,rowIndex:rowIndex}=e.data(this.$selectionCursor),t=this.getCell$(colIndex,rowIndex);if(t&&t!==this.$selectionCursor){const n=e.data(this.$focusedCell);this.$focusedCell=this.getCell$(n.colIndex,n.rowIndex),this.selectArea(t)}}}focusCellOnClusterChanged(){if(this.$focusedCell){const{colIndex:colIndex,rowIndex:rowIndex}=e.data(this.$focusedCell),t=this.getCell$(colIndex,rowIndex);t&&this.focusCell(t,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}}selectArea(t){if(this.$focusedCell)if(this.$editingCell==this.$focusedCell)this._selectArea(this.choosenCell,t)&&(this.$selectionCursor=t);else{if(null===this._selectedCells)return;this._selectArea(this.$focusedCell,t)&&(this.$selectionCursor=t)}}findSelectionDirection(t,n){const i=e.data(t),o=e.data(n);let s=parseInt(i.rowIndex),r=parseInt(i.colIndex),l=parseInt(o.rowIndex),c=parseInt(o.colIndex),a="";return a=s==l?"Horizontal":r==c?"Vertical":{dir:"Diagonal",width:Math.abs(c-r),height:Math.abs(l-s)},this.direction=a,a}_selectArea(t,e){if(t===e)return!1;if(t===this.$editingCell)return!1;if(e===this.$editingCell)return!1;const n=this.getCellsInRange(t,e);let i=this.cellselection.findDirection(t,e);const o=new CustomEvent("selectCells",{detail:{cellRange:t,cells:n,direction:i}});return this.$editingCell&&this.cellselection.addRangetoCell(n),this.instance.wrapper.dispatchEvent(o),!!n&&(this.clearSelection(),this._selectedCells=n.map(t=>this.getCell$(...t)),this.cellselection.selectedCells=this._selectedCells,this.cellselection.cleanup(this.cellselection.selectedCells),requestAnimationFrame(()=>{this.cellselection.cellChoosingMode?this.cellselection.drawGroupCells():this._selectedCells.map(t=>t.classList.add("dt-cell--highlight"))}),!0)}findCorners(t,e,n){let i=t[0],o=t[t.length-1];return[i,t[e],o,t[t.length-e-1]]}cellRangeCleanUp(t){let e=["Vertical","Horizontal"],n=["Top","Right","Bottom","Left"];t.map(t=>{n.forEach(e=>{t.classList.remove(`dt-cell--cellRange-Diagonal-${e}`);t.classList.remove(`dt-cell--cellRange-DiagonalCorner-${e}`)});e.forEach(e=>{t.classList.remove(`dt-cell--cellRange-${e}-Top`);t.classList.remove(`dt-cell--cellRange-${e}-Bottom`);t.classList.remove(`dt-cell--cellRange-${e}`)})})}getCellsInRange(t,n){let i,o,s,r;if("number"==typeof t)[i,o,s,r]=arguments;else if("object"==typeof t){if(!t||!n)return!1;const l=e.data(t),c=e.data(n);i=+l.colIndex,o=+l.rowIndex,s=+c.colIndex,r=+c.rowIndex}if(o>r&&([o,r]=[r,o]),i>s&&([i,s]=[s,i]),this.isStandardCell(i)||this.isStandardCell(s))return!1;const l=[];let c=i,a=o;const h=[];for(;a<=r;)h.push(a),a+=1;return h.map(t=>{for(;c<=s;)l.push([c,t]),c++;c=i}),l}clearSelection(){(this._selectedCells||[]).forEach(t=>t.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(t){this.keyboard.off("backspace"),this.focusCell(t);const{rowIndex:rowIndex,colIndex:colIndex}=e.data(t),n=this.columnmanager.getColumn(colIndex);if(!n||!1!==n.editable&&!1!==n.focusable){const i=this.getCell(colIndex,rowIndex);if(!i||!1!==i.editable){if(this.$editingCell){const{_rowIndex:_rowIndex,_colIndex:_colIndex}=e.data(this.$editingCell);if(rowIndex===_rowIndex&&colIndex===_colIndex)return}if(!(document.querySelectorAll(".dt-cell--editing").length>0)){this.$editingCell=t,t.classList.add("dt-cell--editing");const o=e(".dt-cell__edit",t);o.innerHTML="";const s=this.getEditor(colIndex,rowIndex,i.content,o),r=new CustomEvent("activateEditing",{detail:s});this.instance.wrapper.dispatchEvent(r),s&&(this.currentCellEditor=s,s.initValue(i.content,rowIndex,n))}}}}deactivateEditing(t=!0){t&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null,this.bindClearCells())}getEditor(t,e,n,i){const o=this.datamanager.getColumn(t),s=this.datamanager.getRow(e),r=this.datamanager.getData(e);let l=this.options.getEditor?this.options.getEditor(t,e,n,i,o,s,r):this.getDefaultEditor(i);return!1!==l&&(void 0===l&&(l=this.getDefaultEditor(i)),l)}getDefaultEditor(t){const n=e.create("input",{class:"dt-input",type:"text",inside:t});e.on(n,"input",".dt-input",(t,e)=>{this.observer.notify(n.value)});const i=this;return{initValue(t){n.focus(),n.value=t},getValue(){return n.value},setValue(t){n.value=t,i.observer.notify(t)}}}submitEditing(){let t=Promise.resolve();if(!this.$editingCell)return t;const n=this.$editingCell,{rowIndex:rowIndex,colIndex:colIndex}=e.data(n),i=this.datamanager.getColumn(colIndex);this.currentCellEditor.getValue();if(n){const e=this.currentCellEditor;let o=e.getValue();if(mt(o),e){let s=e.getValue();s.then||(s=Promise.resolve(s)),t=s.then(t=>{const s=this.getCell(colIndex,rowIndex).content;if(s===t)return!1;const r=e.setValue(t,rowIndex,i);this.updateCell(colIndex,rowIndex,t,!0);n.focus();r&&r.then&&r.catch(t=>{console.log(t);this.updateCell(colIndex,rowIndex,s)});const l=new CustomEvent("cellSubmit",{detail:{rowIndex:rowIndex,colIndex:colIndex,value:o}});this.instance.wrapper.dispatchEvent(l);return r})}}return this.cellselection.reset(),this._selectedCells=null,this.currentCellEditor=null,t}copyCellContents(t,n){if(!n&&t){const{colIndex:colIndex,rowIndex:rowIndex}=e.data(t),n=this.getCell(colIndex,rowIndex);return it(n.content),1}const i=this.getCellsInRange(t,n);if(!i)return 0;const o=i.map(t=>this.getCell(...t)).reduce((t,e)=>{const n=e.rowIndex;t[n]=t[n]||[];t[n].push(e.content);return t},[]);return it(o.map(t=>t.join("\t")).join("\n")),o.reduce((t,e)=>t+e.length,0)}pasteContentInCell(t){if(this.$focusedCell){const n=t.split("\n").map(t=>t.split("\t")).filter(t=>t.length&&t.every(t=>t));let{colIndex:colIndex,rowIndex:rowIndex}=e.data(this.$focusedCell),i={colIndex:+colIndex,rowIndex:+rowIndex};n.forEach((t,e)=>{let n=e+i.rowIndex;t.forEach((t,e)=>{let o=e+i.colIndex;this.updateCell(o,n,t,!0)})})}}parseGoogleSheet(){let t=[];const e=(new DOMParser).parseFromString(data,"text/html");if(!e.getElementsByTagName("google-sheets-html-origin")[0])return void console.log("Not a valid google sheet paste ");let n=e.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0];console.log(n);let i=n.getElementsByTagName("tr");return console.log("No of rows in ",i.length),Array.from(i).forEach((e,n)=>{let i={rowIndex:0,colLength:0,data:[]};let o=e.getElementsByTagName("td");console.log("No of cols in ",o.length);console.log(n+1);i.rowIndex=n+1;i.colLength=o.length;Array.from(o).forEach(t=>{i.data.push=t.innerHTML});t.push(i)}),t}activateFilter(t){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(t),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(t,e,n,i=!1){const o=this.datamanager.updateCell(t,e,{content:n});this.refreshCell(o,i)}refreshCell(t,n=!1){e(this.selector(t.colIndex,t.rowIndex),this.bodyScrollable).innerHTML=this.getCellContent(t,n)}toggleTreeButton(t,e){const n=this.columnmanager.getFirstColumnIndex(),i=this.getCell$(n,t);i&&i.classList[e?"remove":"add"]("dt-cell--tree-close")}isStandardCell(t){return t<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(t){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(t))return!1;this.$editingCell&&["tab","shift+tab"].includes(t)&&this.deactivateEditing();let n=this.$focusedCell;if("left"===t||"shift+tab"===t?n=this.getLeftCell$(n):"right"===t||"tab"===t?n=this.getRightCell$(n):"up"===t?n=this.getAboveCell$(n):"down"===t&&(n=this.getBelowCell$(n)),!n)return!1;const{colIndex:colIndex}=e.data(n);if(!this.columnmanager.getColumn(colIndex).focusable){let e=this.$focusedCell;this.unfocusCell(e),this.$focusedCell=n;let i=this.focusCellInDirection(t);return i||this.focusCell(e),i}return this.focusCell(n),!0}getCell$(t,n){return e(this.selector(t,n),this.bodyScrollable)}getAboveCell$(t){const{colIndex:colIndex}=e.data(t);let n=t.parentElement.previousElementSibling;for(;n&&n.classList.contains("dt-row--hide");)n=n.previousElementSibling;return n?e(`.dt-cell--col-${colIndex}`,n):t}getBelowCell$(t){const{colIndex:colIndex}=e.data(t);let n=t.parentElement.nextElementSibling;for(;n&&n.classList.contains("dt-row--hide");)n=n.nextElementSibling;return n?e(`.dt-cell--col-${colIndex}`,n):t}getLeftCell$(t){return t.previousElementSibling}getRightCell$(t){return t.nextElementSibling}getLeftMostCell$(t){return this.getCell$(this.columnmanager.getFirstColumnIndex(),t)}getRightMostCell$(t){return this.getCell$(this.columnmanager.getLastColumnIndex(),t)}getTopMostCell$(t){return this.getCell$(t,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(t){return this.getCell$(t,this.rowmanager.getLastRowIndex())}getCell(t,e){return this.instance.datamanager.getCell(t,e)}getRowHeight(){return e.style(e(".dt-row",this.bodyScrollable),"height")}scrollToCell(t){if(e.inViewport(t,this.bodyScrollable))return!1;const{rowIndex:rowIndex}=e.data(t);return this.rowmanager.scrollToRow(rowIndex),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(t){const{rowIndex:rowIndex,colIndex:colIndex,isHeader:isHeader,isFilter:isFilter,isTotalRow:isTotalRow}=t,e=nt({rowIndex:rowIndex,colIndex:colIndex,isHeader:isHeader,isFilter:isFilter,isTotalRow:isTotalRow}),n=this.datamanager.getRow(rowIndex),i=!(isHeader||isFilter||isTotalRow);return`\n            <div class="${["dt-cell","dt-cell--col-"+colIndex,i?`dt-cell--${colIndex}-${rowIndex}`:"",i?"dt-cell--row-"+rowIndex:"",isHeader?"dt-cell--header":"",isHeader?`dt-cell--header-${colIndex}`:"",isFilter?"dt-cell--filter":"",i&&n&&n.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${e} tabindex="0">\n                ${this.getCellContent(t)}\n            </div>\n        `}getCellContent(t,e=!1){const{isHeader:isHeader,isFilter:isFilter,colIndex:colIndex}=t,n=!isHeader&&!1!==t.editable?this.getEditCellHTML(colIndex):"",i=isHeader&&!1!==t.sortable?`<span class="sort-indicator">\n                ${this.options.sortIndicator[t.sortOrder]}\n            </span>`:"",o=isHeader&&!1!==t.resizable?'<span class="dt-cell__resize-handle"></span>':"",s=isHeader&&!1!==t.dropdown?this.columnmanager.getDropdownHTML():"";let r,l=si.getCustomCellFormatter(t);if(isHeader||isFilter||!l)r=t.content;else if(!t.html||e){const e=this.datamanager.getRow(t.rowIndex),n=this.datamanager.getData(t.rowIndex);r=l(t.content,e,t.column,n)}else r=t.html;if(t.html=r,this.options.treeView&&!isHeader&&!isFilter&&void 0!==t.indent){const e=this.datamanager.getRow(t.rowIndex+1),n=e&&e.meta.indent>t.indent,i=this.datamanager.getColumnIndexById("_rowIndex")+1;if(i===t.colIndex){const e=20*(t.indent||0),i=n?`<span class="dt-tree-node__toggle" style="left: ${e-20}px">\n                        <span class="icon-open">${oi.chevronDown}</span>\n                        <span class="icon-close">${oi.chevronRight}</span>\n                    </span>`:"";r=`<span class="dt-tree-node" style="padding-left: ${e}px">\n                    ${i}\n                    <span>${r}</span>\n                </span>`}}let c=`\n            <div class="${["dt-cell__content",isHeader?`dt-cell__content--header-${colIndex}`:`dt-cell__content--col-${colIndex}`].join(" ")}">\n                ${r}\n                ${i}\n                ${o}\n                ${s}\n            </div>\n            ${n}\n        `,a=document.createElement("div");a.innerHTML=r;let h=a.textContent;return h=h.replace(/\s+/g," ").trim(),c=c.replace(">",` title="${pt(h)}">`)}getEditCellHTML(t){return`<div class="dt-cell__edit dt-cell__edit--col-${t}"></div>`}selector(t,e){return`.dt-cell--${t}-${e}`}static getCustomCellFormatter(t){return t.format||t.column&&t.column.format||null}}class ri{constructor(t){this.instance=t,rt(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){const t=this.datamanager.getColumns();e("div",this.header).innerHTML=this.getHeaderHTML(t),this.$filterRow=e(".dt-row-filter",this.header),this.$filterRow&&e.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(t){let e=this.rowmanager.getRowHTML(t,{isHeader:1});return this.options.inlineFilters&&(e+=this.rowmanager.getRowHTML(t,{isFilter:1})),e}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){function t(t){i.hideDropdown()}this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,e.on(this.header,"click",".dt-dropdown__toggle",t=>{this.openDropdown(t)});const n=e=>{const n=[".dt-dropdown__toggle",".dt-dropdown__toggle *",".dt-dropdown__list",".dt-dropdown__list *"].join(",");if(e.target.matches(n))return;t()};e.on(document.body,"click",n),document.addEventListener("scroll",t,!0),this.instance.on("onDestroy",()=>{e.off(document.body,"click",n);e.off(document,"scroll",t)}),e.on(this.$dropdownList,"click",".dt-dropdown__list-item",(t,n)=>{if(!this._dropdownActiveColIndex)return;const i=this.options.headerDropdown;const{index:index}=e.data(n);const o=this._dropdownActiveColIndex;let s=i[index].action;s&&s.call(this.instance,this.getColumn(o));this.hideDropdown()});const i=this;this.hideDropdown()}openDropdown(t){this._dropdownWidth||(e.style(this.$dropdownList,{display:""}),this._dropdownWidth=e.style(this.$dropdownList,"width")),e.style(this.$dropdownList,{display:"",left:t.clientX-this._dropdownWidth+4+"px",top:t.clientY+4+"px"});const n=e.closest(".dt-cell",t.target),{colIndex:colIndex}=e.data(n);this._dropdownActiveColIndex=colIndex}hideDropdown(){e.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let t,n,i,o=!1;e.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(s,r)=>{document.body.classList.add("dt-resize");const l=r.parentNode.parentNode;t=l;const{colIndex:colIndex}=e.data(t);const c=this.getColumn(colIndex);if(c&&!1===c.resizable)return;o=!0;n=e.style(e(".dt-cell__content",t),"width");i=s.pageX});const s=n=>{document.body.classList.remove("dt-resize");if(!t)return;o=!1;const{colIndex:colIndex}=e.data(t);this.setColumnWidth(colIndex);this.style.setBodyStyle();t=null};e.on(document.body,"mouseup",s),this.instance.on("onDestroy",()=>{e.off(document.body,"mouseup",s)});const r=s=>{if(!o)return;let r=s.pageX-i;"rtl"===this.options.direction&&(r*=-1);const l=n+r;const{colIndex:colIndex}=e.data(t);let c=this.options.minimumColumnWidth;if(c>l)return;this.datamanager.updateColumn(colIndex,{width:l});this.setColumnHeaderWidth(colIndex)};e.on(document.body,"mousemove",r),this.instance.on("onDestroy",()=>{e.off(document.body,"mousemove",r)})}bindPerfectColumnWidth(){e.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(t,n)=>{const i=n.parentNode.parentNode;const{colIndex:colIndex}=e.data(i);let o=this.bodyRenderer.visibleRows.map(t=>t[colIndex]).reduce((t,e)=>t.content.length>e.content.length?t:e);let s=this.cellmanager.getCellHTML(o);let r=document.createElement("div");r.innerHTML=s;let l=r.querySelector(".dt-cell__content").textContent;let{borderLeftWidth:borderLeftWidth,borderRightWidth:borderRightWidth,paddingLeft:paddingLeft,paddingRight:paddingRight}=e.getStyle(this.bodyScrollable.querySelector(".dt-cell__content"));let c=[borderLeftWidth,borderRightWidth,paddingLeft,paddingRight].map(parseFloat).reduce((t,e)=>t+e);let a=e.measureTextWidth(l)+c;this.datamanager.updateColumn(colIndex,{width:a});this.setColumnHeaderWidth(colIndex);this.setColumnWidth(colIndex)})}bindMoveColumn(){if(!this.options.disableReorderColumn){const n=e(".dt-row",this.header);this.sortable=t.create(n,{onEnd:t=>{const{oldIndex:oldIndex,newIndex:newIndex}=t;const n=t.item;const{colIndex:colIndex}=e.data(n);if(+colIndex===newIndex)return;this.switchColumn(oldIndex,newIndex)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}}sortColumn(t,e){this.instance.freeze(),this.sortRows(t,e).then(()=>{this.refreshHeader();return this.rowmanager.refreshRows()}).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(t))})}removeColumn(t){const e=this.getColumn(t);this.instance.freeze(),this.datamanager.removeColumn(t).then(()=>{this.refreshHeader();return this.rowmanager.refreshRows()}).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",e)})}switchColumn(t,e){this.instance.freeze(),this.datamanager.switchColumn(t,e).then(()=>{this.refreshHeader();return this.rowmanager.refreshRows()}).then(()=>{this.setColumnWidth(t);this.setColumnWidth(e);this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(t),this.getColumn(e))})}toggleFilter(t){if(this.options.inlineFilters){let n;(n=void 0===t?!this.isFilterShown:t)?e.style(this.$filterRow,{display:""}):e.style(this.$filterRow,{display:"none"}),this.isFilterShown=n,this.style.setBodyStyle()}}focusFilter(t){this.isFilterShown&&e(`.dt-cell--col-${t} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(this.options.inlineFilters){const t=t=>{this.applyFilter(this.getAppliedFilters())};e.on(this.header,"keydown",".dt-filter",ei(t,300))}}applyFilter(t){this.datamanager.filterRows(t).then(({rowsToShow:rowsToShow})=>{this.rowmanager.showRows(rowsToShow)})}getAppliedFilters(){const t={};return e.each(".dt-filter",this.header).map(e=>{const n=e.value;n&&(t[e.dataset.colIndex]=n)}),t}applyDefaultSortOrder(){const t=this.getColumns().filter(t=>"none"!==t.sortOrder);if(1===t.length){const e=t[0];this.sortColumn(e.colIndex,e.sortOrder)}}sortRows(t,e){return this.datamanager.sortRows(t,e)}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(t,e){t=+t;let n=e||this.getColumn(t).width;const i=[`.dt-cell__content--col-${t}`,`.dt-cell__edit--col-${t}`].join(", "),o={width:n+"px"};this.style.setStyle(i,o)}setColumnHeaderWidth(t){t=+t,this.$columnMap=this.$columnMap||[];const e=`.dt-cell__content--header-${t}`,{width:width}=this.getColumn(t);let n=this.$columnMap[t];n||(n=this.header.querySelector(e),this.$columnMap[t]=n),n.style.width=width+"px"}getColumnMinWidth(t){return t=+t,this.getColumn(t).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(t){return e(`.dt-cell--header-${t}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){const{dropdownButton:dropdownButton}=this.options;return`\n            <div class="dt-dropdown">\n                <div class="dt-dropdown__toggle">${dropdownButton}</div>\n            </div>\n      `}getDropdownListHTML(){const{headerDropdown:dropdownItems}=this.options;return`\n            <div class="dt-dropdown__list">\n            ${dropdownItems.map((t,e)=>`\n                <div class="dt-dropdown__list-item" data-index="${e}">${t.label}</div>\n            `).join("")}\n            </div>\n        `}}class li{constructor(t){this.instance=t,rt(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=st(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){this.options.checkboxColumn&&(this.checkMap=[],e.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(t,n)=>{const i=n.closest(".dt-cell");const{rowIndex:rowIndex,isHeader:isHeader}=e.data(i);const o=n.checked;isHeader?this.checkAll(o):this.checkRow(rowIndex,o)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(t,e){this.datamanager.updateRow(t,e).forEach(t=>{this.cellmanager.refreshCell(t,!0)})}getCheckedRows(){if(!this.checkMap)return[];let t=[];for(let e in this.checkMap){const n=this.checkMap[e];1===n&&t.push(e)}return t}highlightCheckedRows(){this.getCheckedRows().map(t=>this.checkRow(t,!0))}checkRow(t,n){const i=n?1:0,o=t=>`.dt-cell--0-${t} [type="checkbox"]`;this.checkMap[t]=i,e.each(o(t),this.bodyScrollable).map(t=>{t.checked=n}),this.highlightRow(t,n),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(t))}checkAll(t){const n=t?1:0;t?this.datamanager._filteredRows?this.datamanager._filteredRows.forEach(e=>{this.checkRow(e,t)}):this.checkMap=Array.from(Array(this.getTotalRows())).map(t=>n):this.checkMap=[],e.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(e=>{e.checked=t}),this.highlightAll(t),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(this.options.checkedRowStatus){const t=this.getCheckedRows().length;if(t>0){let e=this.instance.translate("{count} rows selected",{count:t});this.bodyRenderer.showToastMessage(e)}else this.bodyRenderer.clearToastMessage()}}highlightRow(t,e=!0){const n=this.getRow$(t);if(n){if(!e&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all"))return void n.classList.add("dt-row--unhighlight");e&&n.classList.contains("dt-row--unhighlight")&&n.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},e?(n.classList.add("dt-row--highlight"),this._highlightedRows[t]=n):(n.classList.remove("dt-row--highlight"),delete this._highlightedRows[t])}}highlightAll(t=!0){if(t)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(const t in this._highlightedRows){const e=this._highlightedRows[t];e.classList.remove("dt-row--highlight")}this._highlightedRows={}}}showRows(t){const e=(t=ht(t)).map(t=>this.datamanager.getRow(t));this.bodyRenderer.renderRows(e)}showAllRows(){const t=this.datamanager.getAllRowIndices();this.showRows(t)}getChildrenToShowForNode(t){return this.datamanager.getRow(t).meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(t)}openSingleNode(t){const e=ut([...this.getChildrenToShowForNode(t),...this.bodyRenderer.visibleRowIndices]).sort(dt);this.showRows(e)}getChildrenToHideForNode(t){this.datamanager.getRow(t).meta.isTreeNodeClose=!0;const e=this.datamanager.getChildren(t);return e.forEach(t=>{const e=this.datamanager.getRow(t);e.meta.isLeaf||(e.meta.isTreeNodeClose=!0)}),e}closeSingleNode(t){const e=this.getChildrenToHideForNode(t),n=this.bodyRenderer.visibleRowIndices.filter(t=>!e.includes(t)).sort(dt);this.showRows(n)}expandAllNodes(){const t=ut([...this.datamanager.getRows().filter(t=>!t.meta.isLeaf).map(t=>this.getChildrenToShowForNode(t.meta.rowIndex)).flat(),...this.bodyRenderer.visibleRowIndices]).sort(dt);this.showRows(t)}collapseAllNodes(){const t=this.datamanager.getRows().filter(t=>0===t.meta.indent).map(t=>this.getChildrenToHideForNode(t.meta.rowIndex)).flat(),e=this.bodyRenderer.visibleRowIndices.filter(e=>!t.includes(e)).sort(dt);this.showRows(e)}setTreeDepth(t){let e=this.datamanager.getRows();const n=e.filter(e=>e.meta.indent<t),i=e.filter(e=>e.meta.indent>=t),o=i.filter(e=>e.meta.indent>t);i.forEach(t=>{t.meta.isLeaf||(t.meta.isTreeNodeClose=!0)}),n.forEach(t=>{t.meta.isLeaf||(t.meta.isTreeNodeClose=!1)});const s=e.filter(t=>!o.includes(t)).map(t=>t.meta.rowIndex).sort(dt);this.showRows(s)}getRow$(t){return e(this.selector(t),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(t){t=+t,this._lastScrollTo=this._lastScrollTo||0;const n=this.getRow$(t);if(!e.inViewport(n,this.bodyScrollable)){const{height:height}=n.getBoundingClientRect(),{top:top,bottom:bottom}=this.bodyScrollable.getBoundingClientRect(),i=Math.floor((bottom-top)/height);let o=0;o=t>this._lastScrollTo?height*(t+1-i):height*(t+1-1),this._lastScrollTo=t,e.scrollTop(this.bodyScrollable,o)}}getRowHTML(t,e){const n=nt(e);let i=e.rowIndex;return e.isFilter&&(t=t.map(t=>Object.assign({},t,{content:this.getFilterInput({colIndex:t.colIndex,name:t.name}),isFilter:1,isHeader:void 0,editable:!1})),i="filter"),e.isHeader&&(i="header"),`\n            <div class="dt-row dt-row-${i}" ${n}>\n                ${t.map(t=>this.cellmanager.getCellHTML(t)).join("")}\n            </div>\n        `}getFilterInput(t){let e=`title="Filter based on ${t.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${nt(t)} tabindex="1"\n            ${0===t.colIndex?"disabled":e} />`}selector(t){return`.dt-row-${t}`}}var ci=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){!function(e){t.exports=function(){return function t(e,n,i){function s(l,c){if(!n[l]){if(!e[l]){var a="function"==typeof o&&o;if(!c&&a)return a(l,!0);if(r)return r(l,!0);var h=new Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[l]={exports:{}};e[l][0].call(u.exports,function(t){var n=e[l][1][t];return s(n||t)},u,u.exports,t,e,n,i)}return n[l].exports}for(var r="function"==typeof o&&o,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s={width:"100%",height:"100%"},r=function(t){return Number(t)===Number(t)},l=function(){function t(e,n){var o=this;i(this,t),this._config={},this._lastRepaint=null,this._maxElementHeight=t.getMaxBrowserHeight(),this.refresh(e,n);var s=this._config;!function t(){var e=o._getScrollPosition(),n=o._lastRepaint;if(o._renderAnimationFrame=window.requestAnimationFrame(t),e!==n&&(!n||Math.abs(e-n)>o._averageHeight)){var i=o._renderChunk();o._lastRepaint=e,!1!==i&&"function"==typeof s.afterRender&&s.afterRender()}}()}return o(t,null,[{key:"create",value:function(e,n){return new t(e,n)}},{key:"mergeStyle",value:function(t,e){for(var n in e)t.style[n]!==e[n]&&(t.style[n]=e[n])}},{key:"getMaxBrowserHeight",value:function(){var e=document.createElement("div"),n=document.createElement("div");t.mergeStyle(e,{position:"absolute",height:"1px",opacity:0}),t.mergeStyle(n,{height:"1e7px"}),e.appendChild(n),document.body.appendChild(e);var i=n.offsetHeight;return document.body.removeChild(e),i}}]),o(t,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(e,n){var i=this;if(Object.assign(this._config,s,n),!e||1!==e.nodeType)throw new Error("HyperList requires a valid DOM Node container");this._element=e;var o=this._config,l=this._scroller||o.scroller||document.createElement(o.scrollerTagName||"tr");if("boolean"!=typeof o.useFragment&&(this._config.useFragment=!0),!o.generate)throw new Error("Missing required `generate` function");if(!r(o.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(o.itemHeight)&&!r(o.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());r(o.itemHeight)?this._itemHeights=Array(o.total).fill(o.itemHeight):this._itemHeights=o.itemHeight,Object.keys(s).filter(function(t){return t in o}).forEach(function(t){var e=o[t],n=r(e),s=!n&&"%"===e.slice(-1);if(e&&"string"!=typeof e&&"number"!=typeof e){var l="Invalid optional `"+t+"`, expected string or number";throw new Error(l)}if(n&&(o[t]=e+"px"),"height"===t){var c=n?e:parseInt(e.replace(/px|%/,""),10);i._containerHeight=s?window.innerHeight*c/100:r(e)?e:c}});var c={width:""+o.width,height:""+o.height,overflow:"auto",position:"relative"};t.mergeStyle(e,c);var a=o.itemHeight*o.total,h=this._maxElementHeight;a>h&&console.warn(["HyperList: The maximum element height",h+"px has","been exceeded; please reduce your item height."].join(" "));var u={opacity:"0",position:"absolute",width:"1px",height:a+"px"};t.mergeStyle(l,u),this._scroller||e.appendChild(l),this._scroller=l,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(o.total).fill(0),this._computePositions(0),this._renderChunk(null!==this._lastRepaint),"function"==typeof o.afterRender&&o.afterRender()}},{key:"_getRow",value:function(e){var n=this._config,i=n.generate(e),o=i.height;if(void 0!==o&&r(o)?(i=i.element,o!==this._itemHeights&&(this._itemHeights[e]=o,this._computePositions(e),this._scrollHeight=this._computeScrollHeight(e))):o=this._itemHeights[e],!i||1!==i.nodeType)throw new Error("Generator did not return a DOM Node for index: "+e);var s=i.getAttribute("class")||"";i.setAttribute("class",s+" "+(n.rowClassName||"vrow"));var l=this._itemPositions[e];return t.mergeStyle(i,{position:"absolute",top:l+"px"}),i}},{key:"_getScrollPosition",value:function(){var t=this._config;return"function"==typeof t.overrideScrollPosition?t.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(t){var e=this._config,n=this._element,i=this._getScrollPosition(),o=e.total,s=e.reverse?this._getReverseFrom(i):this._getFrom(i)-1;if((s<0||s-this._screenItemsLen<0)&&(s=0),!t&&this._lastFrom===s)return!1;this._lastFrom=s;var r=s+this._cachedItemsLen;(r>o||r+this._cachedItemsLen>o)&&(r=o);var l=e.useFragment?document.createDocumentFragment():[],c=this._scroller;l[e.useFragment?"appendChild":"push"](c);for(var a=s;a<r;a++){var h=this._getRow(a);l[e.useFragment?"appendChild":"push"](h)}if(e.applyPatch)return e.applyPatch(n,l);n.innerHTML="",n.appendChild(l)}},{key:"_computePositions",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],e=this._config,n=e.total,i=e.reverse;t<1&&!i&&(t=1);for(var o=t;o<n;o++)i?0===o?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[o]=this._itemPositions[o-1]-this._itemHeights[o]:this._itemPositions[o]=this._itemHeights[o-1]+this._itemPositions[o-1]}},{key:"_computeScrollHeight",value:function(){var e=this,n=this._config,i=n.total,o=this._itemHeights.reduce(function(t,e){return t+e},0);t.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:o+"px"});var s=this._itemHeights.slice(0).sort(function(t,e){return t-e}),r=Math.floor(i/2),l=i%2==0?(s[r]+s[r-1])/2:s[r],c=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(c/l),this._containerHeight=c,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,3*this._screenItemsLen),this._averageHeight=l,n.reverse&&window.requestAnimationFrame(function(){e._element.scrollTop=o}),o}},{key:"_getFrom",value:function(t){for(var e=0;this._itemPositions[e]<t;)e++;return e}},{key:"_getReverseFrom",value:function(t){for(var e=this._config.total-1;e>0&&this._itemPositions[e]<t+this._containerHeight;)e--;return e}}]),t}();n.default=l,e.exports=n.default},{}]},{},[1])(1)}()}()}));class ai{constructor(t){this.instance=t,this.options=t.options,this.datamanager=t.datamanager,this.rowmanager=t.rowmanager,this.cellmanager=t.cellmanager,this.bodyScrollable=t.bodyScrollable,this.footer=this.instance.footer,this.log=t.log}renderRows(t){if(this.visibleRows=t,this.visibleRowIndices=t.map(t=>t.meta.rowIndex),0===t.length)return void(this.bodyScrollable.innerHTML=this.getNoDataHTML());let e=new Set(this.visibleRowIndices);const n=this.datamanager.rowViewOrder.map(t=>{if(e.has(t))return t;return null}).filter(t=>null!==t),i=getComputedStyle(this.bodyScrollable);let o={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:t.length,generate:t=>{const e=document.createElement("div");const i=n[t];const o=this.datamanager.getRow(i);const s=this.rowmanager.getRowHTML(o,o.meta);e.innerHTML=s;return e.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,o):this.hyperlist=new ci(this.bodyScrollable,o),this.renderFooter()}render(){const t=this.datamanager.getRowsForView();this.renderRows(t),this.instance.setDimensions()}renderFooter(){if(this.options.showTotalRow){const t=this.getTotalRow();let e=this.rowmanager.getRowHTML(t,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=e}}getTotalRow(){return this.datamanager.getColumns().map(t=>{let e=null;["_rowIndex","_checkbox"].includes(t.id)&&(e="");return{content:e,isTotalRow:1,colIndex:t.colIndex,column:t}}).map((t,e)=>{if(""===t.content)return t;if(this.options.hooks.columnTotal){const n=this.visibleRows.map(t=>t[e].content),i=this.options.hooks.columnTotal.call(this.instance,n,t);if(null!=i)return t.content=i,t}t.content=this.visibleRows.reduce((t,n)=>{const i=n[e];if("number"==typeof i.content)return null==t&&(t=0),t+i.content;return t},t.content);return t})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(t,e){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(t),e&&setTimeout(()=>{this.clearToastMessage()},1e3*e)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(t){return`<span class="dt-toast__message">${t}</span>`}}class hi{constructor(t){this.instance=t,rt(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+t.constructor.instances,t.datatableWrapper.classList.add(this.scopeClass);const e=document.createElement("style");t.wrapper.insertBefore(e,t.datatableWrapper),this.styleEl=e,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=ti(this.onWindowResize,300),"fluid"===this.options.layout&&e.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,e.on(this.bodyScrollable,"scroll",t=>{if(this._settingHeaderPosition)return;this._settingHeaderPosition=!0;requestAnimationFrame(()=>{const n=-t.target.scrollLeft;e.style(this.header,{transform:`translateX(${n}px)`});let i=document.querySelectorAll('[data-col-index="0"]');i.forEach(t=>{e.style(t,{left:`${-n}px`,"z-index":10,"border-right":"1px solid #d1d8dd"})});e.style(this.footer,{transform:`translateX(${n}px)`});this._settingHeaderPosition=!1})})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),e.off(window,"resize",this.onWindowResize)}setStyle(t,e){if(t.includes(","))return void t.split(",").map(t=>t.trim()).forEach(t=>{this.setStyle(t,e)});if(t=t.trim()){this._styleRulesMap=this._styleRulesMap||{};const n=this._getPrefixedSelector(t);this._styleRulesMap[n]&&(this.removeStyle(t),e=Object.assign({},this._styleRulesMap[n],e));const i=`${n} { ${this._getRuleString(e)} }`;this._styleRulesMap[n]=e,this.stylesheet.insertRule(i)}}removeStyle(t){if(t.includes(","))return void t.split(",").map(t=>t.trim()).forEach(t=>{this.removeStyle(t)});if(t=t.trim()){const e=this._getPrefixedSelector(t),n=Array.from(this.stylesheet.cssRules).findIndex(t=>t.selectorText===e);-1!==n&&this.stylesheet.deleteRule(n)}}_getPrefixedSelector(t){return`.${this.scopeClass} ${t}`}_getRuleString(t){return Object.keys(t).map(e=>{let n=e;e.includes("-")||(n=et(e));return`${n}:${t[e]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){e.each(".dt-cell--header",this.header).map(t=>{const{colIndex:colIndex}=e.data(t);const n=this.getColumn(colIndex);if(!n.minWidth){const i=e.style(e(".dt-cell__content",t),"width");n.minWidth=i}})}setupNaturalColumnWidth(){e(".dt-row")&&(e.each(".dt-row-header .dt-cell",this.header).map(t=>{const{colIndex:colIndex}=e.data(t);const n=this.datamanager.getColumn(colIndex);let i=e.style(e(".dt-cell__content",t),"width");"number"==typeof i&&i>=this.options.minimumColumnWidth?n.naturalWidth=i:n.naturalWidth=this.options.minimumColumnWidth}),e.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(t=>{const{colIndex:colIndex}=e.data(t);const n=this.datamanager.getColumn(colIndex);let i=e.style(e(".dt-cell__content",t),"width");"number"==typeof i&&i>=n.naturalWidth?n.naturalWidth=i:n.naturalWidth=n.naturalWidth}))}setupColumnWidth(){if("ratio"===this.options.layout){let t=e.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){const e=this.datamanager.getColumnById("_rowIndex");t=t-e.width-1}if(this.options.checkboxColumn){const e=this.datamanager.getColumnById("_checkbox");t=t-e.width-1}const n=this.datamanager.getColumns().map(t=>{if("_rowIndex"===t.id||"_checkbox"===t.id)return 0;t.width||(t.width=1);t.ratioWidth=parseInt(t.width,10);return t.ratioWidth}).reduce((t,e)=>t+e),i=t/n;this.datamanager.getColumns().map(t=>{if("_rowIndex"===t.id||"_checkbox"===t.id)return;t.width=Math.floor(i*t.ratioWidth)-1})}else this.datamanager.getColumns().map(t=>{t.width||(t.width=t.naturalWidth);"_rowIndex"===t.id&&(t.width=this.getRowIndexColumnWidth());t.width<this.options.minimumColumnWidth&&(t.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if("fluid"===this.options.layout){const t=e.style(this.instance.datatableWrapper,"width");let n=e(".dt-row",this.bodyScrollable),i=t;if(n)i=e.style(n,"width");else{let t=e(".dt-row",this.instance.header),n=Array.from(t.children).map(t=>t.offsetWidth);i=n.reduce((t,e)=>t+e,0)}const o=this.datamanager.getColumns().filter(t=>t.resizable),s=(t-i)/o.length;o.map(t=>{const n=e.style(this.getColumnHeaderElement(t.colIndex),"width");let i=Math.floor(n+s)-2;this.datamanager.updateColumn(t.colIndex,{width:i})})}}setColumnStyle(){this.datamanager.getColumns().map(t=>{t.align||(t.align="left");["left","center","right"].includes(t.align)||(t.align="left");t.align="center";this.setStyle(`.dt-cell--col-${t.colIndex}`,{"text-align":t.align});this.columnmanager.setColumnHeaderWidth(t.colIndex);this.columnmanager.setColumnWidth(t.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(t=>{this.columnmanager.setColumnHeaderWidth(t.colIndex);this.columnmanager.setColumnWidth(t.colIndex)})}setBodyStyle(){const t=e.style(this.datatableWrapper,"width"),n=e(".dt-row",this.bodyScrollable);if(n){const i=e.style(n,"width");let o=t>i?i+10:t;e.style(this.bodyScrollable,{width:o+"px"}),e.removeStyle(this.bodyScrollable,"height");let s=e.getStyle(this.bodyScrollable,"height");const r=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,l=e.hasHorizontalOverflow(this.bodyScrollable);let c;r<s&&(c=r,l&&(c+=e.scrollbarSize()),e.style(this.bodyScrollable,{height:c+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<e.scrollbarSize()&&e.style(this.bodyScrollable,{overflowY:"hidden"}),"fluid"===this.options.layout&&e.style(this.bodyScrollable,{overflowX:"hidden"})}}getColumnHeaderElement(t){return t=+t,t<0?null:e(`.dt-cell--col-${t}`,this.header)}getRowIndexColumnWidth(){const t=this.datamanager.getRowCount();return e.measureTextWidth(t+"")+22}}const ui={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v",8:"backspace"};class di{constructor(t){this.listeners={},e.on(t,"keydown",this.handler.bind(this))}handler(t){let e=ui[t.keyCode];t.shiftKey&&"shift"!==e&&(e="shift+"+e),(t.ctrlKey&&"ctrl"!==e||t.metaKey&&"meta"!==e)&&(e="ctrl+"+e);const n=this.listeners[e];if(n&&n.length>0)for(let e of n){const n=e(t);void 0!==n&&!0!==n||t.preventDefault()}}on(t,e){t.split(",").map(t=>t.trim()).map(t=>{this.listeners[t]=this.listeners[t]||[];this.listeners[t].push(e)})}off(t,e){t.split(",").map(t=>t.trim()).map(t=>{if(this.listeners[t])if(e){const n=this.listeners[t].indexOf(e);-1!==n&&this.listeners[t].splice(n,1)}else delete this.listeners[t]})}}var fi={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{1:"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{1:"{count} row selected",default:"{count} rows selected"}},gi={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zurücksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{1:"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{1:"{count} Zeile ausgewählt",default:"{count} Zeilen ausgewählt"}},pi={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre décroissant","Reset sorting":"Réinitialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de données","{count} cells copied":{1:"{count} cellule copiée",default:"{count} cellules copiées"},"{count} rows selected":{1:"{count} ligne sélectionnée",default:"{count} lignes sélectionnées"}},mi={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{1:"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{1:"{count} linea selezionata",default:"{count} linee selezionate"}};class wi{constructor(t){this.language=t,this.translations=wt()}addTranslations(t){this.translations=Object.assign(this.translations,t)}translate(t,e){let n=this.translations[this.language]&&this.translations[this.language][t]||t;return"object"==typeof n&&(n=e&&e.count?this.getPluralizedTranslation(n,e.count):t),gt(n,e||{})}getPluralizedTranslation(t,e){return t[e]||t.default}}class Ci{constructor(t){this.instance=t,rt(this,this.instance,["options","datamanager","columnmanager","cellmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer","observer"]),this.avaliableFormulas=this.options.formulas,this.allFormulas=Object.keys(this.avaliableFormulas),this.argSuggestion=this.options.argSuggestion,this.observer.subscribe(this.handleValueUpdate.bind(this)),this.formulas=[],this.confirmedValue=null,this.create(),this.choosenFormula=null,this.tokens=[]}handleValueUpdate(t){this.suggest()}create(){this.formulaSuggest=document.createElement("div"),this.formulaSuggest.classList.add("formula-suggest"),this.instance.wrapper.insertBefore(this.formulaSuggest,this.instance.datatableWrapper)}display(t){if("on"==t){let t=getComputedStyle(this.formulaSuggest);this.originalDimensions={width:t.width,height:t.width};let e=this.cellmanager.$editingCell.getBoundingClientRect();Object.assign(this.formulaSuggest.style,{display:"block",position:"absolute",left:`${e.left}px`,top:`${e.top+e.height}px`})}else"off"==t&&Object.assign(this.formulaSuggest.style,{display:"none"})}search(t){t=t.split("(")[0],console.log("Search Term is",t),this.formulas=[],this.formulas=Object.keys(this.avaliableFormulas).filter(e=>e.startsWith(t.toLowerCase()))}renderOptions(){this.formulaSuggest.innerHTML=" ",this.formulas.forEach(t=>{let n=this.avaliableFormulas[t].desc;let i=document.createElement("div");i.setAttribute("class","formula");i.setAttribute("id",t);let o=document.createTextNode(t);i.appendChild(o);let s=document.createElement("div");let r=document.createElement("p");r.setAttribute("class","formula-description");r.textContent=n;s.appendChild(r);let l=document.createElement("hr");s.appendChild(l);i.appendChild(s);e.on(i,"click",".formula",t=>{this.handleClick(t)});this.formulaSuggest.appendChild(i)})}suggest(){if(this.cellmanager.currentCellEditor){this.changeDimensions("500px","300px");let t=this.cellmanager.currentCellEditor.getValue();if("="===t.charAt(0)){if(this.instance.getCellChoosen()||this.instance.startCellChoosing(),t.length>1){if(t=t.replace("=",""),this.tokens=this.options.scanner(t),this.hasSelected)return this.choosenFormula=this.getFormulaName(),this.createArgSuggestion(this.choosenFormula),void this.suggestArgs();this.search(t),this.formulas.length>1?(this.display("on"),this.renderOptions(),this.hasOpenBracket()?(this.writeConfirmedValue(t),this.choosenFormula=this.getFormulaName(),this.createArgSuggestion(this.choosenFormula),this.suggestArgs(),this.choosenFormula=null):this.changeDimensions("500px","300px")):this.display("off")}}else this.display("off"),this.instance.stopCellChoosing()}}updateEditor(t){let e=this.tokens,n=this.cellmanager.currentCellEditor.getValue(),i=null;e&&(i=this.tokens[this.tokens.length-1]);let o=this.options.scanner(t),s=null;if(15==o[0].type)return s=n.charAt(0)+t,void this.cellmanager.currentCellEditor.setValue(s);if(3==o[0].type){if(console.log("last Token",i),e.length<1)return s=n.charAt(0)+t,void this.cellmanager.currentCellEditor.setValue(s);if(3==i.type){if(this.hasOpenBracket())return console.log("Serious Business"),s=n.charAt(0)+this.stringfyTokens()+t,void this.cellmanager.currentCellEditor.setValue(s);s=n.charAt(0)+t,this.cellmanager.currentCellEditor.setValue(s)}22==i.type&&(s=n.charAt(0)+this.stringfyTokens()+t,this.cellmanager.currentCellEditor.setValue(s)),17==i.type&&(s=n+t,this.cellmanager.currentCellEditor.setValue(s))}}stringfyTokens(){let t="",e=this.tokens.indexOf(this.hasOpenBracket());console.log(this.hasCommas());let n=this.hasCommas(),i=e;if(n.length>0){let t=n[n.length-1],o=this.tokens.indexOf(t);i=Math.max(e,o)}for(let e=0;e<=i;e++)t+=this.tokens[e].value;return t}hasOpenBracket(){return this.tokens.find(t=>17===t.type)}hasCloseBracket(){return this.tokens.find(t=>18===t.type)}hasCommas(){return this.tokens.filter(t=>22===t.type)}writeConfirmedValue(t){let e=this.tokens[this.tokens.length-1];(17===e.type||e)&&(this.confirmedValue=t)}selectOption(t){this.choosenFormula=t,this.hasSelected=!0;this.cellmanager.currentCellEditor.getValue();let e=this.avaliableFormulas[t].completion;console.log(`${e}`),this.updateEditor(`${e}`)}createArgSuggestion(t){this.formulaSuggest.innerHTML=" ";let e=document.createElement("div");e.setAttribute("class","argSuggestConatainer");let n=document.createTextNode(`${t}(`);e.appendChild(n);let i=this.filterArgSuggestion(t);i.parameters.forEach((t,n)=>{const o=document.createElement("span");o.innerText=t.name;e.appendChild(o);if(n!==i.parameters.length-1){const t=document.createTextNode(", ");e.appendChild(t)}});let o=document.createTextNode(")");e.appendChild(o),this.formulaSuggest.appendChild(e)}getFormulaName(){return this.tokens.find(t=>15===t.type).value}suggestArgs(){let t=this.hasCommas();this.changeDimensions("500px","30px");let e=this.formulaSuggest.children[0].children;Array.prototype.slice.call(e).map(t=>t.classList.remove("arg-suggest")),e[-2+t.length+2].classList.add("arg-suggest"),this.hasCloseBracket()&&(this.display("off"),this.hasSelected=!1)}filterArgSuggestion(t){return this.argSuggestion.find(e=>e.name===t)}changeDimensions(t,e){Object.assign(this.formulaSuggest.style,{height:e,width:t})}handleClick(t){this.selectOption(t.target.id)}}class yi{constructor(t){this.instance=t,rt(this,this.instance,["options","datamanager","columnmanager","cellmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer","observer","autocomplete"]),this.startCell=null,this.end=null,this.cellChoosingMode=!1,this.selectedCells=[],this.direction=null,this.observer.subscribe(this.handleUpdate.bind(this)),this.currentValue=""}handleUpdate(t){}selectCell(t){if(this.startCell||(this.currentValue=this.cellmanager.currentCellEditor.getValue()),t===this.cellmanager.$editingCell)return void console.trace();const{colIndex:colIndex,rowIndex:rowIndex}=e.data(t);this.drawCellSelection(t),this.setChosenCell(t),this.addtoCell(t)}setChosenCell(t){console.log(this),this.startCell&&t!==this.startCell&&(console.log(this.selectedCells),this.startCell=null,this.selectedCells.length>1?(this.cleanup(this.selectedCells),this.selectedCells=[]):this.startCell=null),this.startCell=t}groupSelectCells(t){this.cellmanager._selectArea(this.startCell,t)&&(this.$selectionCursor=t)}addRangetoCell(t){let e=this.rowcolToA1(t[0][1],t[0][0]),n=this.rowcolToA1(t[t.length-1][1],t[t.length-1][0]);this.autocomplete.updateEditor(`${e}:${n}`)}drawCellSelection(t){this.startCell&&this.startCell.classList.remove("dt-cell--cellSelected"),t.classList.add("dt-cell--cellSelected")}addtoCell(t){const{rowIndex:rowIndex,colIndex:colIndex}=e.data(t);let n=this.rowcolToA1(rowIndex,colIndex);this.cellmanager.currentCellEditor.getValue();console.log(`${n}`),this.autocomplete.updateEditor(`${n}`)}findDirection(t,n){const i=e.data(t),o=e.data(n);let s=parseInt(i.rowIndex),r=parseInt(i.colIndex),l=parseInt(o.rowIndex),c=parseInt(o.colIndex),a="";return a=s==l?"Horizontal":r==c?"Vertical":{dir:"Diagonal",width:Math.abs(c-r),height:Math.abs(l-s)},this.direction=a,a}drawGroupCells(){if("object"!=typeof this.direction)this.selectedCells[0].classList.add(`dt-cell--cellRange-${this.direction}-Top`),this.selectedCells[this.selectedCells.length-1].classList.add(`dt-cell--cellRange-${this.direction}-Bottom`),this.selectedCells.slice(1,-1).map(t=>t.classList.add(`dt-cell--cellRange-${this.direction}`));else{let t=this.findCorners(this.selectedCells,this.direction.width,this.direction.height),e=["Top","Right","Bottom","Left"];t.forEach((t,n)=>{t.classList.add(`dt-cell--cellRange-DiagonalCorner-${e[n]}`)}),this.selectedCells.slice(1,this.direction.width).map(t=>t.classList.add("dt-cell--cellRange-Diagonal-Top")),this.selectedCells.slice(this.selectedCells.length-1-this.direction.width+1,this.selectedCells.length-1).map(t=>t.classList.add("dt-cell--cellRange-Diagonal-Bottom"));for(let t=this.direction.width+1;t<this.selectedCells.length;t+=this.direction.width+1)t-1>this.direction.width&&this.selectedCells[t-1].classList.add("dt-cell--cellRange-Diagonal-Right"),t<this.selectedCells.length-this.direction.width-1&&this.selectedCells[t].classList.add("dt-cell--cellRange-Diagonal-Left")}}cleanup(t){let e=["Vertical","Horizontal"],n=["Top","Right","Bottom","Left"];t.map(t=>{n.forEach(e=>{t.classList.remove(`dt-cell--cellRange-Diagonal-${e}`);t.classList.remove(`dt-cell--cellRange-DiagonalCorner-${e}`)});e.forEach(e=>{t.classList.remove(`dt-cell--cellRange-${e}-Top`);t.classList.remove(`dt-cell--cellRange-${e}-Bottom`);t.classList.remove(`dt-cell--cellRange-${e}`)})})}findCorners(t,e,n){let i=t[0],o=t[t.length-1];return[i,t[e],o,t[t.length-e-1]]}reset(){this.startCell=null,this.selectedCells=[],this.direction=null,this.autocomplete.confirmedValue=null,this.autocomplete.hasSelected=!1}a1torowcol(t){return{row:parseInt(t.replace(/\D/g,""))-1,col:t.charCodeAt(0)-64}}rowcolToA1(t,e){return t=parseInt(t),e=parseInt(e),`${String.fromCharCode(64+e)}${t+1}`}}class bi{constructor(){this.subscribers=[]}notify(t){this.subscribers.forEach(e=>e(t))}subscribe(t){this.subscribers.push(t)}}class vi{constructor(t){this.instance=t,rt(this,this.instance,["options","datamanager","columnmanager","cellmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer","observer","autocomplete"]),this.defaults={textAlign:"center",borderCell:"",backgroundColor:""},this.supportedStyles={textAlign:{click:t=>{let e=_t(this.cellmanager.$focusedCell);let n=Rt(e.row,e.col);let i={cell:n,type:"textAlign",value:t};this.throwEvent(i)},draw:t=>{this.cellmanager.$focusedCell.style.textAlign=t},redraw:(t,e)=>{console.log("Redrawing");let n=St(t);n.style.textAlign=e}},textDecoration:{click:t=>{let e=_t(this.cellmanager.$focusedCell);let n=Rt(e.row,e.col);let i={cell:n,type:"textDecoration",value:[t]};this.throwEvent(i)},draw:t=>{let e=this.cellmanager.$focusedCell;this.decorateCell(e,t)},redraw:(t,e)=>{console.log("Redrawing");let n=St(t);this.decorateCell(n,e)}},borderCell:{type:"borderCell",fetch:!0,click:t=>this.borderCell(t),draw:t=>this.drawBorder(t)},backgroundColor:{type:"backgroundColor",click:(t,e)=>this.colorBGCell(t,e),draw:(t,e)=>this.applyBackgroundColor(t,e)},merge:{type:"merge",fetch:!0,click:(t,e)=>this.mergeCells(t,e),draw:(t,e)=>this.drawMergedCells(t,e)}}}throwEvent(t){const e=new CustomEvent("addStyle",{detail:{styleData:t}});this.instance.wrapper.dispatchEvent(e)}decorateCell(t,e){"underline"===e?t.style.textDecoration=e:"bold"===e?t.children[0].innerHTML.includes("<b>")||(t.children[0].innerHTML=`<b>${t.children[0].innerHTML}</b>`):"italic"===e&&(t.children[0].innerHTML.includes("<i>")||(t.children[0].innerHTML=`<i>${t.children[0].innerHTML}</i>`))}drawCellStyles(t,e){if(0!=Object.keys(t).length){let n=Object.keys(t);console.log("Styles recived",n),n.forEach(n=>{let i=Object.keys(t[n]);console.log(i);i.forEach(i=>{let o=t[n][i];Array.isArray(o)?o.forEach(t=>{console.log(t);"draw"===e&&this.supportedStyles[i].draw(t);"redraw"===e&&this.supportedStyles[i].redraw(n,t)}):("draw"===e&&this.supportedStyles[i].draw(t[n][i]),"redraw"===e&&this.supportedStyles[i].redraw(n,t[n][i]))})})}}drawSheetStyles(){console.log("Sheet styles are being drawn")}draw(t,e,n){this.drawCellStyles(t,n),this.drawSheetStyles(e,n)}getIndexfromHTML(t){let{rowIndex:rowIndex,colIndex:colIndex}=e.data(t);return{row:rowIndex,col:colIndex}}}let _i={DataManager:ni,CellManager:si,ColumnManager:ri,RowManager:li,BodyRenderer:ai,Style:hi,Keyboard:di,AutoComplete:Ci,CellSelection:yi,ContentOberserver:bi,DrawManager:vi};class xi{constructor(t,n){if(xi.instances++,"string"==typeof t&&(t=document.querySelector(t)),this.wrapper=t,this.$=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(n),this.setDefaultOptions(),this.buildOptions(n),this.prepare(),this.initializeComponents(),this.refreshonWindowResize(),this.options.fullHeight&&this.makeFullheight(),this.options.reactive&&this.initReactivity(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initReactivity(){const t={get(e,n){if("isProxy"==n)return!0;const i=e[n];if(void 0!==i)return i.isProxy||"object"!=typeof i||(e[n]=new Proxy(i,t)),e[n]},set(t,e,n){return t[e]=n,!0}};this.options.data=new Proxy(this.options.data,t)}initializeTranslations(t){this.language=t.language||"en",this.translationManager=new wi(this.language),t.translations&&this.translationManager.addTranslations(t.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=vt(this)}buildOptions(t){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},t),t.headerDropdown=t.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...t.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},t.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let t=Object.assign({},_i,this.options.overrideComponents),{Style:Style$$1,Keyboard:Keyboard$$1,DataManager:DataManager$$1,RowManager:RowManager$$1,ColumnManager:ColumnManager$$1,CellManager:CellManager$$1,BodyRenderer:BodyRenderer$$1,AutoComplete:AutoComplete$$1,CellSelection:CellSelection$$1,ContentOberserver:ContentOberserver$$1,DrawManager:DrawManager$$1}=t;this.style=new Style$$1(this),this.keyboard=new Keyboard$$1(this.wrapper),this.datamanager=new DataManager$$1(this.options),this.rowmanager=new RowManager$$1(this),this.columnmanager=new ColumnManager$$1(this),this.observer=new ContentOberserver$$1(this),this.autocomplete=new AutoComplete$$1(this),this.cellmanager=new CellManager$$1(this),this.bodyRenderer=new BodyRenderer$$1(this),this.cellselection=new CellSelection$$1(this),this.drawmanager=new DrawManager$$1(this)}prepareDom(){this.wrapper.innerHTML=`\n            <div class="datatable" dir="${this.options.direction}">\n                <div class="dt-header"></div>\n                <div class="dt-scrollable"></div>\n                <div class="dt-footer"></div>\n                <div class="dt-freeze">\n                    <span class="dt-freeze__message">\n                        ${this.options.freezeMessage}\n                    </span>\n                </div>\n                <div class="dt-toast"></div>\n                <div class="dt-dropdown-container"></div>\n                <textarea class="dt-paste-target"></textarea>\n            </div>\n        `,this.datatableWrapper=e(".datatable",this.wrapper),this.header=e(".dt-header",this.wrapper),this.footer=e(".dt-footer",this.wrapper),this.bodyScrollable=e(".dt-scrollable",this.wrapper),this.freezeContainer=e(".dt-freeze",this.wrapper),this.toastMessage=e(".dt-toast",this.wrapper),this.pasteTarget=e(".dt-paste-target",this.wrapper),this.dropdownContainer=e(".dt-dropdown-container",this.wrapper)}refresh(t,e){this.datamanager.init(t,e),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(t){this.datamanager.appendRows(t),this.rowmanager.refreshRows()}refreshRow(t,e){this.rowmanager.refreshRow(t,e)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(t,e){this.bodyRenderer.showToastMessage(t,e)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(t,e){return this.datamanager.getCell(t,e)}getColumnHeaderElement(t){return this.columnmanager.getColumnHeaderElement(t)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=e.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(t,e){this.columnmanager.sortColumn(t,e)}removeColumn(t){this.columnmanager.removeColumn(t)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){e.style(this.freezeContainer,{display:""})}unfreeze(){e.style(this.freezeContainer,{display:"none"})}updateOptions(t){this.buildOptions(t)}fireEvent(t,...e){const n=[...this._internalEventHandlers[t]||[],this.events[t]].filter(Boolean);for(let t of n)t.apply(this,e)}on(t,e){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[t]=this._internalEventHandlers[t]||[],this._internalEventHandlers[t].push(e)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(t,e){return this.translationManager.translate(t,e)}makeFullheight(){document.querySelector(":root").style.setProperty("--dt-scroll-height","100vh")}refreshonWindowResize(){const t=this;window.addEventListener("resize",function(e){t.refresh()},!0)}startCellChoosing(){this.cellselection.cellChoosingMode=!0}getCellChoosing(){return this.cellselection.cellChoosingMode}stopCellChoosing(){this.cellselection.cellChoosingMode=!1}getCurrentCellEditor(){this.cellmanager.currentCellEditor}getCellChoosen(){return this.cellmanager.choosenCell}createFormulaSuggest(){let t=document.createElement("div");t.setAttribute("class","formula-suggest"),this.wrapper.appendChild(t)}}xi.instances=0;var Ii={name:"frappe-datatable",version:"0.0.0-development",description:"A modern datatable library for the web",main:"dist/frappe-datatable.cjs.js",unpkg:"dist/frappe-datatable.min.js",jsdelivr:"dist/frappe-datatable.min.js",scripts:{start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz",sheets:"cp dist/frappe-datatable.min.js ../new-bench/apps/sheets/frontend/src && cp dist/frappe-datatable.min.css ../new-bench/apps/sheets/frontend/src && cp node_modules/sortablejs/Sortable.js ../new-bench/apps/sheets/frontend/src"},files:["dist","src"],devDependencies:{autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},repository:{type:"git",url:"https://github.com/frappe/datatable.git"},keywords:["datatable","data","grid","table"],author:"Faris Ansari",license:"MIT",bugs:{url:"https://github.com/frappe/datatable/issues"},homepage:"https://frappe.io/datatable",dependencies:{hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},config:{commitizen:{path:"cz-conventional-changelog"}}};return xi.__version__=Ii.version,xi}(Sortable);
